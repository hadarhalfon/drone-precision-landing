<mujoco model="drone_landing">
    <option timestep="0.001"/>
    <option integrator="RK4" density="1.225" viscosity="1.8e-5"/>
    <compiler inertiafromgeom="false"
              meshdir="/Users/hadarhalfon/PycharmProjects/pythonProject1/assets/cf2"
              autolimits="true"/>
    <visual>
        <!-- טווח הערפל (מוגדר ב-map) -->
        <map fogstart="1" fogend="5"/>
        <!-- צבע/שקיפות הערפל (מוגדר ב-rgba.fog) -->
        <rgba fog="0.9 0.9 0.9 0.0"/>
    </visual>



    <!-- Softer, more damped contacts + higher sliding friction -->
    <default>
        <default class="cf2">
            <default class="visual">
                <geom group="2" type="mesh" contype="0" conaffinity="0"/>
            </default>
            <default class="collision">
                <geom group="3" type="mesh"
                      solref="0.02 1.0"
                      solimp="0.90 0.95 0.001"
                      friction="1.2 0.8 0.001"
                      condim="6"/>
            </default>
            <site group="5"/>
        </default>
    </default>

    <asset>
        <material name="polished_plastic" rgba="0.631 0.659 0.678 1"/>
        <material name="polished_gold" rgba="0.969 0.878 0.6 1"/>
        <material name="medium_gloss_plastic" rgba="0.109 0.184 0.0 1"/>
        <material name="propeller_plastic" rgba="0.792 0.820 0.933 1"/>
        <material name="white" rgba="1 1 1 1"/>
        <material name="body_frame_plastic" rgba="0.102 0.102 0.102 1"/>
        <material name="burnished_chrome" rgba="0.898 0.898 0.898 1"/>

        <!-- meshes -->
        <mesh file="cf2_0.obj"/>
        <mesh file="cf2_1.obj"/>
        <mesh file="cf2_2.obj"/>
        <mesh file="cf2_3.obj"/>
        <mesh file="cf2_4.obj"/>
        <mesh file="cf2_5.obj"/>
        <mesh file="cf2_6.obj"/>
        <mesh file="cf2_collision_0.obj"/>
        <mesh file="cf2_collision_1.obj"/>
        <mesh file="cf2_collision_2.obj"/>
        <mesh file="cf2_collision_3.obj"/>
        <mesh file="cf2_collision_4.obj"/>
        <mesh file="cf2_collision_5.obj"/>
        <mesh file="cf2_collision_6.obj"/>
        <mesh file="cf2_collision_7.obj"/>
        <mesh file="cf2_collision_8.obj"/>
        <mesh file="cf2_collision_9.obj"/>
        <mesh file="cf2_collision_10.obj"/>
        <mesh file="cf2_collision_11.obj"/>
        <mesh file="cf2_collision_12.obj"/>
        <mesh file="cf2_collision_13.obj"/>
        <mesh file="cf2_collision_14.obj"/>
        <mesh file="cf2_collision_15.obj"/>
        <mesh file="cf2_collision_16.obj"/>
        <mesh file="cf2_collision_17.obj"/>
        <mesh file="cf2_collision_18.obj"/>
        <mesh file="cf2_collision_19.obj"/>
        <mesh file="cf2_collision_20.obj"/>
        <mesh file="cf2_collision_21.obj"/>
        <mesh file="cf2_collision_22.obj"/>
        <mesh file="cf2_collision_23.obj"/>
        <mesh file="cf2_collision_24.obj"/>
        <mesh file="cf2_collision_25.obj"/>
        <mesh file="cf2_collision_26.obj"/>
        <mesh file="cf2_collision_27.obj"/>
        <mesh file="cf2_collision_28.obj"/>
        <mesh file="cf2_collision_29.obj"/>
        <mesh file="cf2_collision_30.obj"/>
        <mesh file="cf2_collision_31.obj"/>
    </asset>

    <worldbody>
        <!-- Drone -->
        <body name="cf2" pos="2 0 2" childclass="cf2">
            <joint type="free" damping="0.05"/>
            <inertial pos="0 0 0" mass="0.027" diaginertia="2.3951e-5 2.3951e-5 3.2347e-5"/>
            <camera name="track" pos="-1 0 .5" xyaxes="0 -1 0 1 0 2" mode="trackcom"/>

            <!-- visual geoms -->
            <geom mesh="cf2_0" material="propeller_plastic" class="visual"/>
            <geom mesh="cf2_1" material="medium_gloss_plastic" class="visual"/>
            <geom mesh="cf2_2" material="polished_gold" class="visual"/>
            <geom mesh="cf2_3" material="polished_plastic" class="visual"/>
            <geom mesh="cf2_4" material="burnished_chrome" class="visual"/>
            <geom mesh="cf2_5" material="body_frame_plastic" class="visual"/>
            <geom mesh="cf2_6" material="white" class="visual"/>

            <!-- collision geoms -->
            <geom mesh="cf2_collision_0" class="collision"/>
            <geom mesh="cf2_collision_1" class="collision"/>
            <geom mesh="cf2_collision_2" class="collision"/>
            <geom mesh="cf2_collision_3" class="collision"/>
            <geom mesh="cf2_collision_4" class="collision"/>
            <geom mesh="cf2_collision_5" class="collision"/>
            <geom mesh="cf2_collision_6" class="collision"/>
            <geom mesh="cf2_collision_7" class="collision"/>
            <geom mesh="cf2_collision_8" class="collision"/>
            <geom mesh="cf2_collision_9" class="collision"/>
            <geom mesh="cf2_collision_10" class="collision"/>
            <geom mesh="cf2_collision_11" class="collision"/>
            <geom mesh="cf2_collision_12" class="collision"/>
            <geom mesh="cf2_collision_13" class="collision"/>
            <geom mesh="cf2_collision_14" class="collision"/>
            <geom mesh="cf2_collision_15" class="collision"/>
            <geom mesh="cf2_collision_16" class="collision"/>
            <geom mesh="cf2_collision_17" class="collision"/>
            <geom mesh="cf2_collision_18" class="collision"/>
            <geom mesh="cf2_collision_19" class="collision"/>
            <geom mesh="cf2_collision_20" class="collision"/>
            <geom mesh="cf2_collision_21" class="collision"/>
            <geom mesh="cf2_collision_22" class="collision"/>
            <geom mesh="cf2_collision_23" class="collision"/>
            <geom mesh="cf2_collision_24" class="collision"/>
            <geom mesh="cf2_collision_25" class="collision"/>
            <geom mesh="cf2_collision_26" class="collision"/>
            <geom mesh="cf2_collision_27" class="collision"/>
            <geom mesh="cf2_collision_28" class="collision"/>
            <geom mesh="cf2_collision_29" class="collision"/>
            <geom mesh="cf2_collision_30" class="collision"/>
            <geom mesh="cf2_collision_31" class="collision"/>

            <site name="imu"/>
            <site name="actuation"/>
        </body>

        <!-- Floor -->
        <geom name="floor" type="plane" pos="0 0 0" size="50 50 0.1" rgba="0.9 0.9 0.9 1"/>

        <!-- Platform -->
        <body name="platform_root" pos="0 0 0">
            <joint name="platform_x" type="slide" axis="1 0 0" range="-10 10" damping="5"/>
            <joint name="platform_y" type="slide" axis="0 1 0" range="-10 10" damping="5"/>
            <body name="platform" pos="0 0 0.05">
                <inertial pos="0 0 0" mass="0.5" diaginertia="0.01 0.01 0.01"/>
                <geom type="box" size="2 2 0.05" rgba="0 0 1 1"
                      solref="0.02 1.0" solimp="0.90 0.95 0.001"
                      friction="1.2 0.8 0.001" condim="6"/>
                <geom name="success_zone_disk" type="cylinder"
                      size="0.20 0.0005" pos="0 0 0.0507"
                      rgba="0 1 0 0.45" contype="0" conaffinity="0" condim="6" group="2"/>
                <site name="platform_top_touch" type="box" pos="0 0 0.05" size="2 2 0.001" rgba="0 0 0 0"/>
                <site name="success_zone_touch" type="cylinder" pos="0 0 0.0507" size="0.20 0.001" rgba="0 1 0 0.1"/>
            </body>
        </body>
    </worldbody>

        <actuator>
        <!-- Drone actuators: N and N·m directly (matches set_actuator_control) -->
        <general class="cf2" name="u_thrust" site="actuation"
                 ctrllimited="true" ctrlrange="0 0.53"   gear="0 0 1 0 0 0"/>
        <general class="cf2" name="u_mx"     site="actuation"
                 ctrllimited="true" ctrlrange="-0.01 0.01" gear="0 0 0 1 0 0"/>
        <general class="cf2" name="u_my"     site="actuation"
                 ctrllimited="true" ctrlrange="-0.01 0.01" gear="0 0 0 0 1 0"/>
        <general class="cf2" name="u_mz"     site="actuation"
                 ctrllimited="true" ctrlrange="-0.003 0.003" gear="0 0 0 0 0 1"/>

        <!-- Platform position servos (existing) -->
        <position name="px_cmd" joint="platform_x" kp="100" ctrlrange="-5 5"/>
        <position name="py_cmd" joint="platform_y" kp="100" ctrlrange="-5 5"/>

        <!-- Platform velocity servos (direct speed control, if תרצי להשתמש) -->
        <velocity name="px_vel_cmd" joint="platform_x" kv="100" ctrlrange="-3 3"/>
        <velocity name="py_vel_cmd" joint="platform_y" kv="100" ctrlrange="-3 3"/>
    </actuator>


    <sensor>
        <!-- Drone sensors -->
        <gyro name="body_gyro" site="imu"/>
        <accelerometer name="body_linacc" site="imu"/>
        <framequat name="body_quat" objtype="site" objname="imu"/>

        <!-- Platform joint state (added for convenience) -->
        <jointpos name="px_meas" joint="platform_x"/>
        <jointpos name="py_meas" joint="platform_y"/>
        <jointvel name="vx_meas" joint="platform_x"/>
        <jointvel name="vy_meas" joint="platform_y"/>
        <touch name="touch_top" site="platform_top_touch"/>
        <touch name="touch_success" site="success_zone_touch"/>
    </sensor>

    <!-- הנעילה שנדליק בזמן ריצה (אל תפעילי עד שמתקיים קריטריון הנחיתה) -->
    <equality>
        <weld name="drone_platform_weld" body1="platform" body2="cf2"
              solref="0.02 1.0" solimp="0.90 0.95 0.001" active="false"/>
    </equality>
</mujoco>

